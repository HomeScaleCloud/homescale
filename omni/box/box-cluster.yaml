kind: Cluster
name: box
kubernetes:
  version: v1.30.8
talos:
  version: v1.9.1
patches:
  - name: pod-security-exemptions
    inline:
      cluster:
        apiServer:
          admissionControl:
          - name: PodSecurity
            configuration:
              exemptions:
                namespaces:
                - rook-ceph
                - argocd
                - metrics
                - gitea
                - authentik
  - name: kubelet-serving-cert-approver
    inline:
      cluster:
        extraManifests:
          - https://raw.githubusercontent.com/alex1989hu/kubelet-serving-cert-approver/main/deploy/standalone-install.yaml
      machine:
        kubelet:
          extraArgs:
            rotate-server-certificates: true
---
kind: ControlPlane
machineClass:
  name: desired-box
  size: unlimited